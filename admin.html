<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Admin - Master Control</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { margin: 0; font-family: 'Roboto', sans-serif; background-color: #f4f7f6; display: flex; height: 100vh; }
        .sidebar { width: 260px; background-color: #1a237e; color: white; display: flex; flex-direction: column; padding: 20px; }
        .nav-item { padding: 12px; margin-bottom: 8px; cursor: pointer; border-radius: 6px; }
        .nav-item:hover, .nav-item.active { background-color: #3949ab; }
        .main-content { flex: 1; padding: 30px; overflow-y: auto; }
        
        table { width: 100%; border-collapse: collapse; background: white; box-shadow: 0 2px 5px rgba(0,0,0,0.05); margin-top: 15px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; font-size: 14px; }
        th { background-color: #eee; }
        
        .btn { padding: 6px 12px; border: none; border-radius: 4px; cursor: pointer; color: white; margin-right: 5px; font-size: 12px; }
        .btn-add { background-color: #2e7d32; padding: 10px 20px; font-size: 14px; float: right; }
        .btn-edit { background-color: #ffa000; color: #333; } 
        .btn-del { background-color: #d32f2f; }
        
        /* MODAL */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); justify-content: center; align-items: center; z-index: 1000; }
        .modal-content { background: white; padding: 25px; width: 500px; border-radius: 8px; max-height: 90vh; overflow-y: auto; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; font-size: 12px; }
        input { width: 100%; padding: 8px; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px; }

        .section { display: none; }
        .section.active { display: block; }
    </style>
</head>
<body>

<div class="sidebar">
    <h2>Super Admin</h2>
    <div class="nav-item active" onclick="showSection('users')">üë• Manage Users</div>
    <div class="nav-item" onclick="showSection('policies')">üìú Policy Library</div>
    <div class="nav-item" onclick="showSection('settings')">‚öôÔ∏è Admin Settings</div>
</div>

<div class="main-content">
    
    <div id="users" class="section active">
        <h2>DSA Users <button class="btn btn-add" onclick="openUserModal()">+ Create User</button></h2>
        <table id="userTable">
            <thead><tr><th>Name</th><th>Mobile</th><th>Username</th><th>Password</th><th>Status</th><th>Actions</th></tr></thead>
            <tbody></tbody> 
        </table>
    </div>

    <div id="policies" class="section">
        <h2>Bank Policies <button class="btn btn-add" onclick="openPolicyModal()">+ Add Policy</button></h2>
        <table id="policyTable">
            <thead><tr><th>Bank Name</th><th>Type</th><th>Min Turn.</th><th>ROI</th><th>Actions</th></tr></thead>
            <tbody></tbody> 
        </table>
    </div>

    <div id="settings" class="section">
        <h2>Admin Settings</h2>
        <div style="background:white; padding:20px; max-width:400px; border-radius:8px;">
            <label>Admin Username</label>
            <input type="text" id="adminUser" value="admin">
            <br><br>
            <label>Current Password</label>
            <input type="password" id="adminPass" placeholder="Enter current password">
            <br><br>
            <label>New Password</label>
            <input type="password" id="adminNewPass" placeholder="Enter new password">
            <br><br>
            <button class="btn btn-add" onclick="alert('Admin Credentials Updated!')">Update Credentials</button>
        </div>
    </div>

</div>

<div id="userModal" class="modal">
    <div class="modal-content">
        <h3>User Details</h3>
        <input type="hidden" id="u_id">
        <div class="form-row">
            <div><label>Name</label><input type="text" id="u_name"></div>
            <div><label>Mobile</label><input type="text" id="u_mobile"></div>
        </div>
        <div class="form-row">
            <div><label>Username</label><input type="text" id="u_user"></div>
            <div><label>Password</label><input type="text" id="u_pass"></div>
        </div>
        <button class="btn btn-add" onclick="saveUser()">Save</button>
        <button class="btn btn-del" onclick="closeModal('userModal')">Close</button>
    </div>
</div>

<div id="policyModal" class="modal">
    <div class="modal-content">
        <h3>Edit Policy Rules</h3>
        <input type="hidden" id="p_id">
        
        <label>Bank Name</label>
        <input type="text" id="p_name" style="margin-bottom:10px;">
        
        <div class="form-row">
            <div><label>Program Type (STBL/HTBL/OD)</label><input type="text" id="p_type"></div>
            <div><label>Min Turnover (Lakhs)</label><input type="number" id="p_turn"></div>
        </div>
        <div class="form-row">
            <div><label>Min Vintage (Yrs)</label><input type="number" id="p_vin"></div>
            <div><label>Min CIBIL</label><input type="number" id="p_cibil"></div>
        </div>
        <div class="form-row">
            <div><label>ROI (%)</label><input type="number" id="p_roi"></div>
            <div><label>Max Tenure (Months)</label><input type="number" id="p_ten"></div>
        </div>
        
        <button class="btn btn-add" onclick="savePolicy()">Save Policy</button>
        <button class="btn btn-del" onclick="closeModal('policyModal')">Close</button>
    </div>
</div>

<script>
    // --- DATA ---
    let users = JSON.parse(localStorage.getItem('admin_users')) || [
        { name: "Rahul DSA", mobile: "9876543210", user: "rahul", pass: "12345", status: "Active" }
    ];

    let policies = JSON.parse(localStorage.getItem('admin_policies')) || [
        { name: "TATA CAPITAL STBL", type:"STBL", turn: 20, vin: 2, cibil: 700, roi: 18, ten: 36 },
        { name: "ADITYA BIRLA STBL", type:"STBL", turn: 25, vin: 2, cibil: 710, roi: 17.5, ten: 36 },
        { name: "BAJAJ FINANCE TERM", type:"TERM", turn: 40, vin: 3, cibil: 720, roi: 16.5, ten: 48 },
        { name: "TATA CAPITAL HTBL", type:"HTBL", turn: 200, vin: 4, cibil: 725, roi: 14, ten: 60 },
        { name: "ADITYA BIRLA DROP OD", type:"OD", turn: 100, vin: 3, cibil: 740, roi: 12, ten: 12 }
    ];

    // --- RENDER ---
    function render() {
        // Users
        let h1 = "";
        users.forEach((u,i) => {
            h1 += `<tr><td>${u.name}</td><td>${u.mobile}</td><td>${u.user}</td><td>${u.pass}</td><td>${u.status}</td>
            <td><button class="btn btn-edit" onclick="editUser(${i})">Edit</button><button class="btn btn-del" onclick="delUser(${i})">Del</button></td></tr>`;
        });
        document.querySelector('#userTable tbody').innerHTML = h1;

        // Policies
        let h2 = "";
        policies.forEach((p,i) => {
            h2 += `<tr><td>${p.name}</td><td>${p.type}</td><td>${p.turn}L</td><td>${p.roi}%</td>
            <td><button class="btn btn-edit" onclick="editPolicy(${i})">Edit</button><button class="btn btn-del" onclick="delPolicy(${i})">Del</button></td></tr>`;
        });
        document.querySelector('#policyTable tbody').innerHTML = h2;
        
        // Save
        localStorage.setItem('admin_users', JSON.stringify(users));
        localStorage.setItem('admin_policies', JSON.stringify(policies));
    }

    // --- ACTIONS ---
    function showSection(id) { document.querySelectorAll('.section').forEach(d=>d.classList.remove('active')); document.getElementById(id).classList.add('active'); }
    function closeModal(id) { document.getElementById(id).style.display = 'none'; }
    
    // User Logic
    function openUserModal() { document.getElementById('userModal').style.display='flex'; document.getElementById('u_id').value=''; }
    function saveUser() {
        let u = { name: document.getElementById('u_name').value, mobile: document.getElementById('u_mobile').value, user: document.getElementById('u_user').value, pass: document.getElementById('u_pass').value, status: "Active" };
        let id = document.getElementById('u_id').value;
        if(id) users[id] = u; else users.push(u);
        closeModal('userModal'); render();
    }
    function editUser(i) { document.getElementById('u_id').value=i; document.getElementById('u_name').value=users[i].name; document.getElementById('u_mobile').value=users[i].mobile; document.getElementById('u_user').value=users[i].user; document.getElementById('u_pass').value=users[i].pass; document.getElementById('userModal').style.display='flex'; }
    function delUser(i) { if(confirm('Delete?')) { users.splice(i,1); render(); } }

    // Policy Logic
    function openPolicyModal() { document.getElementById('policyModal').style.display='flex'; document.getElementById('p_id').value=''; }
    function savePolicy() {
        let p = {
            name: document.getElementById('p_name').value,
            type: document.getElementById('p_type').value,
            turn: document.getElementById('p_turn').value,
            vin: document.getElementById('p_vin').value,
            cibil: document.getElementById('p_cibil').value,
            roi: document.getElementById('p_roi').value,
            ten: document.getElementById('p_ten').value
        };
        let id = document.getElementById('p_id').value;
        if(id) policies[id] = p; else policies.push(p);
        closeModal('policyModal'); render();
    }
    function editPolicy(i) {
        let p = policies[i];
        document.getElementById('p_id').value=i;
        document.getElementById('p_name').value=p.name; document.getElementById('p_type').value=p.type;
        document.getElementById('p_turn').value=p.turn; document.getElementById('p_vin').value=p.vin;
        document.getElementById('p_cibil').value=p.cibil; document.getElementById('p_roi').value=p.roi;
        document.getElementById('p_ten').value=p.ten;
        document.getElementById('policyModal').style.display='flex';
    }
    function delPolicy(i) { if(confirm('Delete Policy?')) { policies.splice(i,1); render(); } }

    render();
</script>
</body>
</html>
